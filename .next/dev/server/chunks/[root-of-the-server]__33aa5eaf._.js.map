{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rafi2/Rank%20Time%20%28Vibe%29/ranktime/src/lib/db.ts"],"sourcesContent":["// src/lib/db.ts\r\nimport { MongoClient } from 'mongodb';\r\nimport mongoose from 'mongoose';\r\n\r\nif (!process.env.MONGODB_URI) {\r\n  throw new Error('Invalid/Missing environment variable: \"MONGODB_URI\"');\r\n}\r\n\r\nconst uri = process.env.MONGODB_URI;\r\nconst options = {\r\n  maxPoolSize: 10,\r\n  serverSelectionTimeoutMS: 5000,\r\n  socketTimeoutMS: 45000,\r\n  maxIdleTimeMS: 30000,\r\n};\r\n\r\ndeclare global {\r\n  // eslint-disable-next-line no-var\r\n  var _mongoClientPromise: Promise<MongoClient> | undefined;\r\n  // eslint-disable-next-line no-var\r\n  var _mongooseConn: Promise<typeof mongoose> | undefined;\r\n}\r\n\r\nlet client: MongoClient;\r\nlet clientPromise: Promise<MongoClient>;\r\n\r\nif (process.env.NODE_ENV === 'development') {\r\n  // In development mode, use a global variable so that the value\r\n  // is preserved across module reloads caused by HMR (Hot Module Replacement).\r\n  if (!global._mongoClientPromise) {\r\n    client = new MongoClient(uri, options);\r\n    global._mongoClientPromise = client.connect();\r\n  }\r\n  clientPromise = global._mongoClientPromise;\r\n} else {\r\n  // In production mode, it's best to not use a global variable.\r\n  client = new MongoClient(uri, options);\r\n  clientPromise = client.connect();\r\n}\r\n\r\nexport async function connectToDatabase() {\r\n  try {\r\n    const client = await clientPromise;\r\n    return client;\r\n  } catch (error) {\r\n    console.error('Database connection error:', error);\r\n    throw new Error(`Failed to connect to database: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n  }\r\n}\r\n\r\n// Mongoose connection for models â€” cached on global to avoid multiple connections in serverless\r\nexport default async function connectDB() {\r\n  if (global._mongooseConn) {\r\n    return global._mongooseConn;\r\n  }\r\n\r\n  global._mongooseConn = (async () => {\r\n    try {\r\n      return await mongoose.connect(uri);\r\n    } catch (error) {\r\n      console.error('Mongoose connection error:', error);\r\n      global._mongooseConn = undefined;\r\n      throw error;\r\n    }\r\n  })();\r\n\r\n  return global._mongooseConn;\r\n}"],"names":[],"mappings":";;;;;;AAAA,gBAAgB;AAChB;AACA;;;AAEA;;AAIA,MAAM;AACN,MAAM,UAAU;IACd,aAAa;IACb,0BAA0B;IAC1B,iBAAiB;IACjB,eAAe;AACjB;AASA,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,+DAA+D;IAC/D,6EAA6E;IAC7E,IAAI,CAAC,OAAO,mBAAmB,EAAE;QAC/B,SAAS,IAAI,0MAAW,CAAC,KAAK;QAC9B,OAAO,mBAAmB,GAAG,OAAO,OAAO;IAC7C;IACA,gBAAgB,OAAO,mBAAmB;AAC5C;;AAMO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM;QACrB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM,IAAI,MAAM,CAAC,+BAA+B,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,iBAAiB;IAC9G;AACF;AAGe,eAAe;IAC5B,IAAI,OAAO,aAAa,EAAE;QACxB,OAAO,OAAO,aAAa;IAC7B;IAEA,OAAO,aAAa,GAAG,CAAC;QACtB,IAAI;YACF,OAAO,MAAM,yMAAQ,CAAC,OAAO,CAAC;QAChC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,OAAO,aAAa,GAAG;YACvB,MAAM;QACR;IACF,CAAC;IAED,OAAO,OAAO,aAAa;AAC7B"}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rafi2/Rank%20Time%20%28Vibe%29/ranktime/src/lib/auth.ts"],"sourcesContent":["// src/lib/auth.ts\r\nimport { hash, compare } from 'bcryptjs';\r\nimport { NextAuthOptions } from 'next-auth';\r\nimport CredentialsProvider from 'next-auth/providers/credentials';\r\nimport { connectToDatabase } from '@/lib/db';\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"email\" },\r\n        password: { label: \"Password\", type: \"password\" }\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials) return null;\r\n\r\n        let client;\r\n        try {\r\n          client = await connectToDatabase();\r\n          const db = client.db();\r\n\r\n          const user = await db.collection('users').findOne({\r\n            email: credentials.email,\r\n          });\r\n\r\n          if (!user) {\r\n            throw new Error('No user found!');\r\n          }\r\n\r\n          if (user.verified === false) {\r\n            throw new Error('Email not verified');\r\n          }\r\n\r\n          const isValid = await verifyPassword(\r\n            credentials.password,\r\n            user.password\r\n          );\r\n\r\n          if (!isValid) {\r\n            throw new Error('Invalid password!');\r\n          }\r\n\r\n          return {\r\n            id: user._id.toString(),\r\n            email: user.email,\r\n            name: user.name,\r\n          };\r\n        } catch (error) {\r\n          console.error('Auth error:', error);\r\n          throw error;\r\n        }\r\n        // Don't close client in serverless - let connection pool handle it\r\n      },\r\n    }),\r\n  ],\r\n  session: {\r\n    strategy: 'jwt',\r\n    maxAge: 30 * 24 * 60 * 60, // 30 days\r\n    updateAge: 24 * 60 * 60, // 24 hours\r\n  },\r\n  jwt: {\r\n    maxAge: 30 * 24 * 60 * 60, // 30 days\r\n  },\r\n  cookies: {\r\n    sessionToken: {\r\n      name: `next-auth.session-token`,\r\n      options: {\r\n        httpOnly: true,\r\n        sameSite: 'lax',\r\n        path: '/',\r\n        secure: false, // Set to false for localhost development\r\n        maxAge: 30 * 24 * 60 * 60, // 30 days\r\n      },\r\n    },\r\n    callbackUrl: {\r\n      name: `next-auth.callback-url`,\r\n      options: {\r\n        sameSite: 'lax',\r\n        path: '/',\r\n        secure: false,\r\n        maxAge: 30 * 24 * 60 * 60,\r\n      },\r\n    },\r\n    csrfToken: {\r\n      name: 'next-auth.csrf-token',\r\n      options: {\r\n        httpOnly: true,\r\n        sameSite: 'lax',\r\n        path: '/',\r\n        secure: false,\r\n        maxAge: 30 * 24 * 60 * 60,\r\n      },\r\n    },\r\n  },\r\n  callbacks: {\r\n    async jwt({ token, user, account }) {\r\n      // Persist the OAuth access_token and or the user id to the token right after signin\r\n      if (account) {\r\n        token.accessToken = account.access_token;\r\n      }\r\n      if (user) {\r\n        token.id = user.id;\r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      // Send properties to the client, like an access_token and user id from a provider\r\n      if (token) {\r\n        session.user.id = token.id as string;\r\n      }\r\n      return session;\r\n    },\r\n  },\r\n  pages: {\r\n    signIn: '/login',\r\n  },\r\n};\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  return await hash(password, 12);\r\n}\r\n\r\nexport async function verifyPassword(\r\n  password: string,\r\n  hashedPassword: string\r\n): Promise<boolean> {\r\n  return await compare(password, hashedPassword);\r\n}"],"names":[],"mappings":";;;;;;;;AAAA,kBAAkB;AAClB;AAEA;AACA;;;;AAEO,MAAM,cAA+B;IAC1C,MAAM;IACN,WAAW;QACT,IAAA,2MAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,OAAO;gBAEzB,IAAI;gBACJ,IAAI;oBACF,SAAS,MAAM,IAAA,6KAAiB;oBAChC,MAAM,KAAK,OAAO,EAAE;oBAEpB,MAAM,OAAO,MAAM,GAAG,UAAU,CAAC,SAAS,OAAO,CAAC;wBAChD,OAAO,YAAY,KAAK;oBAC1B;oBAEA,IAAI,CAAC,MAAM;wBACT,MAAM,IAAI,MAAM;oBAClB;oBAEA,IAAI,KAAK,QAAQ,KAAK,OAAO;wBAC3B,MAAM,IAAI,MAAM;oBAClB;oBAEA,MAAM,UAAU,MAAM,eACpB,YAAY,QAAQ,EACpB,KAAK,QAAQ;oBAGf,IAAI,CAAC,SAAS;wBACZ,MAAM,IAAI,MAAM;oBAClB;oBAEA,OAAO;wBACL,IAAI,KAAK,GAAG,CAAC,QAAQ;wBACrB,OAAO,KAAK,KAAK;wBACjB,MAAM,KAAK,IAAI;oBACjB;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,eAAe;oBAC7B,MAAM;gBACR;YACA,mEAAmE;YACrE;QACF;KACD;IACD,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;QACvB,WAAW,KAAK,KAAK;IACvB;IACA,KAAK;QACH,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,SAAS;QACP,cAAc;YACZ,MAAM,CAAC,uBAAuB,CAAC;YAC/B,SAAS;gBACP,UAAU;gBACV,UAAU;gBACV,MAAM;gBACN,QAAQ;gBACR,QAAQ,KAAK,KAAK,KAAK;YACzB;QACF;QACA,aAAa;YACX,MAAM,CAAC,sBAAsB,CAAC;YAC9B,SAAS;gBACP,UAAU;gBACV,MAAM;gBACN,QAAQ;gBACR,QAAQ,KAAK,KAAK,KAAK;YACzB;QACF;QACA,WAAW;YACT,MAAM;YACN,SAAS;gBACP,UAAU;gBACV,UAAU;gBACV,MAAM;gBACN,QAAQ;gBACR,QAAQ,KAAK,KAAK,KAAK;YACzB;QACF;IACF;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE;YAChC,oFAAoF;YACpF,IAAI,SAAS;gBACX,MAAM,WAAW,GAAG,QAAQ,YAAY;YAC1C;YACA,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;YACpB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,kFAAkF;YAClF,IAAI,OAAO;gBACT,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;YAC5B;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;AACF;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,MAAM,IAAA,iLAAI,EAAC,UAAU;AAC9B;AAEO,eAAe,eACpB,QAAgB,EAChB,cAAsB;IAEtB,OAAO,MAAM,IAAA,oLAAO,EAAC,UAAU;AACjC"}},
    {"offset": {"line": 300, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rafi2/Rank%20Time%20%28Vibe%29/ranktime/src/models/Session.ts"],"sourcesContent":["import mongoose, { Document, Schema, Types } from 'mongoose';\r\n\r\nexport interface ILap {\r\n  name: string;\r\n  duration: number; // in seconds\r\n  startedAt: Date;\r\n  endedAt: Date;\r\n  comment?: string;\r\n}\r\n\r\nexport interface ISession extends Document {\r\n  user: Types.ObjectId;\r\n  problemId: string;\r\n  problemName: string;\r\n  problemUrl: string;\r\n  problemRating: number;\r\n  problemTags: string[];\r\n  laps: ILap[];\r\n  totalTime: number; // in seconds\r\n  score: number;\r\n  streakBonus: number;\r\n  notes?: string;\r\n  comments?: string;\r\n  codeforcesHandle: string;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst LapSchema = new Schema<ILap>({\r\n  name: { type: String, required: true },\r\n  duration: { type: Number, required: true },\r\n  startedAt: { type: Date, required: true },\r\n  endedAt: { type: Date, required: true },\r\n  comment: { type: String },\r\n});\r\n\r\nconst SessionSchema = new Schema<ISession>(\r\n  {\r\n    user: { type: Schema.Types.ObjectId, ref: 'User', required: true },\r\n    problemId: { type: String, required: true },\r\n    problemName: { type: String, required: true },\r\n    problemUrl: { type: String, required: true },\r\n    problemRating: { type: Number, required: true },\r\n    problemTags: [{ type: String }],\r\n    laps: [LapSchema],\r\n    totalTime: { type: Number, required: true },\r\n    score: { type: Number, required: true },\r\n    streakBonus: { type: Number, default: 0 },\r\n    notes: { type: String },\r\n    comments: { type: String },\r\n    codeforcesHandle: { type: String, required: true },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\n// Create index for faster queries\r\nSessionSchema.index({ user: 1, createdAt: -1 });\r\n\r\n// Create a model or use the existing one if it's already been created\r\nexport default mongoose.models?.Session || mongoose.model<ISession>('Session', SessionSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AA4BA,MAAM,YAAY,IAAI,wMAAM,CAAO;IACjC,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,WAAW;QAAE,MAAM;QAAM,UAAU;IAAK;IACxC,SAAS;QAAE,MAAM;QAAM,UAAU;IAAK;IACtC,SAAS;QAAE,MAAM;IAAO;AAC1B;AAEA,MAAM,gBAAgB,IAAI,wMAAM,CAC9B;IACE,MAAM;QAAE,MAAM,wMAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;IAAK;IACjE,WAAW;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC1C,aAAa;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC5C,YAAY;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC3C,eAAe;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC9C,aAAa;QAAC;YAAE,MAAM;QAAO;KAAE;IAC/B,MAAM;QAAC;KAAU;IACjB,WAAW;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC1C,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,aAAa;QAAE,MAAM;QAAQ,SAAS;IAAE;IACxC,OAAO;QAAE,MAAM;IAAO;IACtB,UAAU;QAAE,MAAM;IAAO;IACzB,kBAAkB;QAAE,MAAM;QAAQ,UAAU;IAAK;AACnD,GACA;IAAE,YAAY;AAAK;AAGrB,kCAAkC;AAClC,cAAc,KAAK,CAAC;IAAE,MAAM;IAAG,WAAW,CAAC;AAAE;uCAG9B,yMAAQ,CAAC,MAAM,EAAE,WAAW,yMAAQ,CAAC,KAAK,CAAW,WAAW"}},
    {"offset": {"line": 392, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rafi2/Rank%20Time%20%28Vibe%29/ranktime/src/models/User.ts"],"sourcesContent":["import mongoose, { Document, Schema } from 'mongoose';\r\n\r\nexport interface IUser extends Document {\r\n  name: string;\r\n  email: string;\r\n  emailVerified?: Date;\r\n  image?: string;\r\n  codeforcesHandle?: string;\r\n  usertag: string; // Unique random tag for each user\r\n  following: mongoose.Types.ObjectId[]; // Array of user IDs this user follows\r\n  totalScore: number;\r\n  currentStreak: number;\r\n  maxStreak: number;\r\n  lastSessionDate?: Date;\r\n  league: 'bronze' | 'silver' | 'gold' | 'platinum' | 'diamond' | 'master' | 'grandmaster';\r\n  rank: number;\r\n  totalSessions: number;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst UserSchema = new Schema<IUser>(\r\n  {\r\n    name: { type: String, required: true },\r\n    email: { type: String, required: true, unique: true },\r\n    emailVerified: { type: Date },\r\n    image: { type: String },\r\n    codeforcesHandle: { type: String },\r\n    usertag: { type: String, required: true, unique: true },\r\n    following: [{ type: Schema.Types.ObjectId, ref: 'User' }],\r\n    totalScore: { type: Number, default: 0 },\r\n    currentStreak: { type: Number, default: 0 },\r\n    maxStreak: { type: Number, default: 0 },\r\n    lastSessionDate: { type: Date },\r\n    league: {\r\n      type: String,\r\n      enum: ['bronze', 'silver', 'gold', 'platinum', 'diamond', 'master', 'grandmaster'],\r\n      default: 'bronze',\r\n    },\r\n    rank: { type: Number, default: 0 },\r\n    totalSessions: { type: Number, default: 0 },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\n// Create a model or use the existing one if it's already been created\r\nexport default mongoose.models?.User || mongoose.model<IUser>('User', UserSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAqBA,MAAM,aAAa,IAAI,wMAAM,CAC3B;IACE,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACpD,eAAe;QAAE,MAAM;IAAK;IAC5B,OAAO;QAAE,MAAM;IAAO;IACtB,kBAAkB;QAAE,MAAM;IAAO;IACjC,SAAS;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACtD,WAAW;QAAC;YAAE,MAAM,wMAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAO;KAAE;IACzD,YAAY;QAAE,MAAM;QAAQ,SAAS;IAAE;IACvC,eAAe;QAAE,MAAM;QAAQ,SAAS;IAAE;IAC1C,WAAW;QAAE,MAAM;QAAQ,SAAS;IAAE;IACtC,iBAAiB;QAAE,MAAM;IAAK;IAC9B,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAU;YAAU;YAAQ;YAAY;YAAW;YAAU;SAAc;QAClF,SAAS;IACX;IACA,MAAM;QAAE,MAAM;QAAQ,SAAS;IAAE;IACjC,eAAe;QAAE,MAAM;QAAQ,SAAS;IAAE;AAC5C,GACA;IAAE,YAAY;AAAK;uCAIN,yMAAQ,CAAC,MAAM,EAAE,QAAQ,yMAAQ,CAAC,KAAK,CAAQ,QAAQ"}},
    {"offset": {"line": 472, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rafi2/Rank%20Time%20%28Vibe%29/ranktime/src/app/api/sessions/route.ts"],"sourcesContent":["// src/app/api/sessions/route.ts\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { getServerSession } from 'next-auth';\r\nimport { authOptions } from '@/lib/auth';\r\nimport connectDB from '@/lib/db';\r\nimport Session from '@/models/Session';\r\nimport User from '@/models/User';\r\n\r\nexport const dynamic = 'force-dynamic';\r\nexport const runtime = 'nodejs';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const session = await getServerSession(authOptions);\r\n    if (!session?.user?.email) {\r\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n    }\r\n\r\n    await connectDB();\r\n\r\n    const body = await request.json();\r\n    const { problemName, problemRating, laps, totalTime, score, comments } = body;\r\n\r\n    // Find the user\r\n    const user = await User.findOne({ email: session.user.email });\r\n    if (!user) {\r\n      return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n    }\r\n\r\n    // Calculate streak bonus\r\n    let streakBonus = 0;\r\n    const yesterday = new Date();\r\n    yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n    const lastSession = await Session.findOne({\r\n      userId: user._id,\r\n      createdAt: { $gte: yesterday }\r\n    }).sort({ createdAt: -1 });\r\n\r\n    if (lastSession) {\r\n      user.currentStreak += 1;\r\n      if (user.currentStreak > user.maxStreak) {\r\n        user.maxStreak = user.currentStreak;\r\n      }\r\n      streakBonus = Math.floor(user.currentStreak / 5) * 10; // Bonus every 5 streak days\r\n    } else {\r\n      user.currentStreak = 1;\r\n    }\r\n\r\n    // Update user stats\r\n    user.totalScore += score + streakBonus;\r\n    user.totalSessions += 1;\r\n\r\n    // Update rank based on total score\r\n    const allUsers = await User.find({}).sort({ totalScore: -1 });\r\n    const userRank = allUsers.findIndex(u => u._id.toString() === user._id.toString()) + 1;\r\n    user.rank = userRank;\r\n\r\n    // Update league based on score\r\n    if (user.totalScore >= 10000) user.league = 'Legend';\r\n    else if (user.totalScore >= 5000) user.league = 'Master';\r\n    else if (user.totalScore >= 2500) user.league = 'Expert';\r\n    else if (user.totalScore >= 1000) user.league = 'Advanced';\r\n    else if (user.totalScore >= 500) user.league = 'Intermediate';\r\n    else user.league = 'Beginner';\r\n\r\n    await user.save();\r\n\r\n    // Create session\r\n    const newSession = new Session({\r\n      userId: user._id,\r\n      problemName,\r\n      problemRating,\r\n      laps,\r\n      totalTime,\r\n      score: score + streakBonus,\r\n      streakBonus,\r\n      comments\r\n    });\r\n\r\n    await newSession.save();\r\n\r\n    return NextResponse.json({\r\n      message: 'Session saved successfully',\r\n      session: newSession,\r\n      streakBonus\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Error saving session:', error);\r\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const session = await getServerSession(authOptions);\r\n    if (!session?.user?.email) {\r\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n    }\r\n\r\n    await connectDB();\r\n\r\n    const user = await User.findOne({ email: session.user.email });\r\n    if (!user) {\r\n      return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n    }\r\n\r\n    const sessions = await Session.find({ userId: user._id })\r\n      .sort({ createdAt: -1 })\r\n      .limit(50);\r\n\r\n    return NextResponse.json(sessions);\r\n\r\n  } catch (error) {\r\n    console.error('Error fetching sessions:', error);\r\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":"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"}}]
}